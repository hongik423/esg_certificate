# M-CENTER 랜딩페이지 AI 진단 신청 구글시트 연동 설정 가이드

## 📋 개요

AI 진단 시작하기 버튼 클릭 시 신청자 정보를 자동으로 구글시트에 저장하는 시스템을 설정하는 방법입니다.

**시트명**: `m_center_landingpage-request`
**폼타입**: AI 무료진단

## 🚀 1단계: 구글 스프레드시트 생성

1. [Google Sheets](https://sheets.google.com)에 접속
2. 새 스프레드시트 생성
3. 스프레드시트 이름을 `M-CENTER 랜딩페이지 신청 데이터`로 변경
4. 스프레드시트 URL에서 ID 복사 (나중에 사용)
   ```
   https://docs.google.com/spreadsheets/d/[여기가_스프레드시트_ID]/edit
   ```

## 🔧 2단계: Google Apps Script 설정

### 2-1. Apps Script 프로젝트 생성

1. 구글 스프레드시트에서 `확장` → `Apps Script` 클릭
2. 새 프로젝트가 열리면 프로젝트 이름을 `m_center_landingpage-request`로 변경

### 2-2. 스크립트 코드 입력

1. `Code.gs` 파일에 아래 코드를 복사하여 붙여넣기:

```javascript
// docs/m_center_landingpage-request_apps_script.js 파일의 전체 내용을 복사
```

### 2-3. 웹 앱 배포

1. 상단 메뉴에서 `배포` → `새 배포` 클릭
2. 설정:
   - **유형**: 웹 앱
   - **설명**: M-CENTER AI 진단 신청 데이터 수집
   - **실행 계정**: 나
   - **액세스 권한**: 모든 사용자
3. `배포` 버튼 클릭
4. 권한 승인 과정 진행
5. **웹 앱 URL 복사** (중요!)
   ```
   https://script.google.com/macros/s/[스크립트_ID]/exec
   ```

## ⚙️ 3단계: 환경변수 설정

### 3-1. .env.local 파일 설정

프로젝트 루트에 `.env.local` 파일 생성 또는 수정:

```env
# Google Apps Script 웹 앱 URL
NEXT_PUBLIC_GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/[발급받은_스크립트_ID]/exec

# 다른 환경변수들...
OPENAI_API_KEY=your_openai_api_key
```

### 3-2. 환경변수 적용

```bash
# 개발 서버 재시작
npm run dev
```

## ✅ 4단계: 테스트

### 4-1. Apps Script 테스트

1. Apps Script 편집기에서 `testAIDiagnosisData` 함수 선택
2. `실행` 버튼 클릭
3. 로그에서 성공 메시지 확인
4. 구글 스프레드시트에 테스트 데이터가 추가되었는지 확인

### 4-2. 웹사이트 테스트

1. 개발 서버에서 `/services/diagnosis` 페이지 접속
2. "무료 진단 시작하기" 버튼 클릭
3. 폼 작성 후 제출
4. 구글 스프레드시트에 데이터가 저장되는지 확인

## 📊 생성되는 시트 구조

| 컬럼명 | 설명 | 예시 |
|--------|------|------|
| 제출일시 | 신청 일시 | 2025. 1. 27. 오후 2:30:45 |
| 회사명 | 신청 회사명 | ㈜테크놀로지 |
| 업종 | 사업 업종 | IT/소프트웨어 |
| 사업담당자 | 사업담당자명 | 김사업 |
| 직원수 | 회사 직원수 | 6-10명 |
| 사업성장단계 | 현재 사업 단계 | 2단계 프로토타입단계 (Seed단계) |
| 주요고민사항 | 상세 고민 내용 | 매출 증대가 가장 큰 고민입니다... |
| 예상혜택 | 기대하는 결과 | 월 매출 30% 증가, 고객 만족도 향상 |
| 진행사업장 | 사업장 위치 | 서울시 강남구 |
| 담당자명 | 연락 담당자 | 홍길동 |
| 연락처 | 전화번호 | 010-1234-5678 |
| 이메일 | 이메일 주소 | contact@company.com |
| 개인정보동의 | 동의 여부 | 동의 |
| 폼타입 | 신청 폼 구분 | AI_무료진단 |

## 🛠️ 문제 해결

### 자주 발생하는 오류

1. **403 Forbidden 오류**
   - Apps Script 권한 설정 확인
   - 웹 앱 액세스 권한을 "모든 사용자"로 설정

2. **CORS 오류**
   - Apps Script에서 CORS 헤더가 자동으로 처리됨
   - 웹 앱 URL이 정확한지 확인

3. **데이터가 저장되지 않음**
   - Apps Script 실행 로그 확인
   - 개인정보 동의 체크박스 확인
   - 필수 입력 항목 누락 확인

### 로그 확인 방법

1. Apps Script 편집기에서 `실행` → `실행 트랜스크립트` 클릭
2. 최근 실행 로그 확인
3. 오류 메시지가 있다면 해당 내용으로 문제 해결

## 📈 모니터링

### 데이터 조회

Apps Script에서 `getAllRequestData()` 함수를 실행하여 저장된 모든 데이터를 조회할 수 있습니다.

### 자동 알림 설정 (선택사항)

Apps Script에 트리거를 추가하여 새로운 신청이 있을 때 이메일 알림을 받을 수 있습니다.

## 🔒 보안 고려사항

1. **개인정보 보호**: 수집된 데이터는 GDPR 및 개인정보보호법을 준수하여 관리
2. **접근 권한**: 구글 스프레드시트 접근 권한을 필요한 사람에게만 부여
3. **데이터 보관**: 개인정보 수집 및 이용 동의서에 명시된 기간 동안만 보관
4. **정기 검토**: 주기적으로 불필요한 데이터 정리

## 📞 지원

문제가 발생하거나 추가 기능이 필요한 경우:
1. Apps Script 실행 로그 확인
2. 브라우저 개발자 도구 네트워크 탭 확인
3. API 응답 상태 코드 및 메시지 확인

---

**✨ 설정 완료 후 AI 진단 시작하기 버튼을 클릭하면 신청자 정보가 자동으로 구글시트에 저장됩니다!** 